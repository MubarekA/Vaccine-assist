<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8"> <!--  unicode 8   -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0"><!--  scalling for mobile   -->
		<meta name="description" content="Find out where to get your vaccine at!"><!--  general description   -->
		<link rel="stylesheet" href="/static/index.css" />
		<title>Vaccine Locator</title><!--  Tab name   -->
	</head>
	<body>
		<script>
			// Set up global variable
			var result;
			
			function showPosition() {
				// Store the element where the page displays the result
				result = document.getElementById("result");
				
				// If geolocation is available, try to get the visitor's position
				if(navigator.geolocation) {
					navigator.geolocation.getCurrentPosition(successCallback, errorCallback);
					result.innerHTML = "Getting the position information...";
				} else {
					alert("Sorry, your browser does not support HTML5 geolocation.");
				}
			};
			
			// Define callback function for successful attempt
			function successCallback(position) {
				result.innerHTML = "Your current position is (" + "Latitude: " + position.coords.latitude + ", " + "Longitude: " + position.coords.longitude + ")";
			}
			
			// Define callback function for failed attempt
			function errorCallback(error) {
				if(error.code == 1) {
					result.innerHTML = "You've decided not to share your position.";
				} else if(error.code == 2) {
					result.innerHTML = "The network is down or the positioning service can't be reached.";
				} else if(error.code == 3) {
					result.innerHTML = "The attempt timed out before it could get the location data.";
				} else {
					result.innerHTML = "Geolocation failed due to unknown error.";
				}
			}
			
      		function do_ajax() {
            	var req = new XMLHttpRequest();
        		var result1 = document.getElementById("result1");
        		req.onreadystatechange = function()
        		{
        //   		if(this.readyState == 4 && this.status == 200) {
        //     		result1.innerHTML = this.responseText;
        //   		} else {
        //     		result1.innerHTML = "Could Not parse";
        //   }
        }

        req.open('POST', '/get_user_location', true);
        req.setRequestHeader('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');
        req.send("result=" + document.getElementById("result").innerHTML);
      }
    </script>


			
		</script>
    <p>Click Here To Find Nearest Vaccine</p>

		<form action="get_user_location" method="post" enctype= "multipart/form-data">
			<button type="button" id="btn-post" onclick="do_ajax();">Click</button>
			<div>
				<p id="result"></p>
				<p id ="result1"></p>
			</div>
			
			<!-- <textarea id="result">{{result}}</textarea> -->
	    </form>
		<button type="button" onclick="showPosition();">Find Vaccine</button>
		   
    </body>
</html>